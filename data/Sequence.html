<!DOCTYPE html>
<html><head title="Doc"><meta charset="UTF-8"/><link href="../styles.css" rel="stylesheet"/></head><body><nav class="sidebar"><h3>Modules</h3><ul><li><li><a href="../Engine.html">Engine</a></li></li><li><li><a href="../Log.html">Log</a></li></li><li><li><a href="../data/Meta.html">data/Meta</a></li></li><li><li><a href="../data/Sequence.html">data/Sequence</a></li></li><li><li><a href="../types/Eval.html">types/Eval</a></li></li><li><li><a href="../types/Graph.html">types/Graph</a></li></li><li><li><a href="../types/Log.html">types/Log</a></li></li></ul><h3>Declarations</h3><ul><li><li><a href="#type.Name">Name</a></li></li><li><li><a href="#type.Meta">Meta</a></li></li><li><li><a href="#type.TreeMeta">TreeMeta</a></li></li><li><li><a href="#type.Exp">Exp</a></li></li><li><li><a href="#type.TreeOfStreamRec">TreeOfStreamRec</a></li></li><li><li><a href="#type.Array">Array</a></li></li><li><li><a href="#type.ArrayStream">ArrayStream</a></li></li><li><li><a href="#type.Cons">Cons</a></li></li><li><li><a href="#type.Bin">Bin</a></li></li><li><li><a href="#type.Val">Val</a></li></li><li><li><a href="#type.Tree">Tree</a></li></li><li><li><a href="#type.Stream">Stream</a></li></li><li><li><a href="#type.SeqType">SeqType</a></li></li><li><li><a href="#type.Result">Result</a></li></li><li><li><a href="#type.EvalResult">EvalResult</a></li></li><li><li><a href="#type.Error">Error</a></li></li><li><li><a href="#type.Ops">Ops</a></li></li><li><li><a href="#type.Sequence">Sequence</a></li></li></ul></nav><div class="documentation"><h1>data/Sequence</h1><div class="declaration"><h4 class="type-declaration" id="type.Name"><span class="keyword">type </span><span class="type">Name</span> = <a href="Meta.html#type.Name"><span class="type">Meta.Name</span></a></h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Meta"><span class="keyword">type </span><span class="type">Meta</span> = <a href="Meta.html#type.Meta"><span class="type">Meta.Meta</span></a></h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.TreeMeta"><span class="keyword">type </span><span class="type">TreeMeta</span> = { name : <a href="#type.Name"><span class="type">Name</span></a>; level : <a href="Meta.html#type.Level"><span class="type">Meta.Level</span></a>; size : <span class="type">Nat</span> }</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Exp"><span class="keyword">type </span><span class="type">Exp</span>&lt;<span class="type">Val_</span>&gt; = {#array : [(<a href="#type.Exp"><span class="type">Exp</span></a>&lt;<span class="type">Val_</span>&gt;, <a href="Meta.html#type.Meta"><span class="type">Meta.Meta</span></a>)]; #put : (<a href="#type.Name"><span class="type">Name</span></a>, <a href="#type.Exp"><span class="type">Exp</span></a>&lt;<span class="type">Val_</span>&gt;); #at : <a href="#type.Name"><span class="type">Name</span></a>; #cons : { head : <a href="#type.Exp"><span class="type">Exp</span></a>&lt;<span class="type">Val_</span>&gt;; meta : <a href="#type.Exp"><span class="type">Exp</span></a>&lt;<span class="type">Val_</span>&gt;; tail : <a href="#type.Exp"><span class="type">Exp</span></a>&lt;<span class="type">Val_</span>&gt; }; #nil; #val : <span class="type">Val_</span>; #streamOfArray : <a href="#type.Exp"><span class="type">Exp</span></a>&lt;<span class="type">Val_</span>&gt;; #treeOfStream : <a href="#type.Exp"><span class="type">Exp</span></a>&lt;<span class="type">Val_</span>&gt;; #treeOfStreamRec : <a href="#type.TreeOfStreamRec"><span class="type">TreeOfStreamRec</span></a>&lt;<span class="type">Val_</span>&gt;; #maxOfTree : <a href="#type.Exp"><span class="type">Exp</span></a>&lt;<span class="type">Val_</span>&gt;}</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.TreeOfStreamRec"><span class="keyword">type </span><span class="type">TreeOfStreamRec</span>&lt;<span class="type">Val_</span>&gt; = { parentLevel : ?<span class="type">Nat</span>; stream : <a href="#type.Stream"><span class="type">Stream</span></a>&lt;<span class="type">Val_</span>&gt;; subTree : <a href="#type.Tree"><span class="type">Tree</span></a>&lt;<span class="type">Val_</span>&gt; }</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Array"><span class="keyword">type </span><span class="type">Array</span>&lt;<span class="type">Val_</span>&gt; = [(<a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;, <a href="Meta.html#type.Meta"><span class="type">Meta.Meta</span></a>)]</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.ArrayStream"><span class="keyword">type </span><span class="type">ArrayStream</span>&lt;<span class="type">Val_</span>&gt; = { array : <a href="#type.Array"><span class="type">Array</span></a>&lt;<span class="type">Val_</span>&gt;; offset : <span class="type">Nat</span> }</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Cons"><span class="keyword">type </span><span class="type">Cons</span>&lt;<span class="type">Val_</span>&gt; = (<a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;, <a href="#type.Meta"><span class="type">Meta</span></a>, <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;)</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Bin"><span class="keyword">type </span><span class="type">Bin</span>&lt;<span class="type">Val_</span>&gt; = { left : <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;; meta : <a href="#type.TreeMeta"><span class="type">TreeMeta</span></a>; right : <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt; }</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Val"><span class="keyword">type </span><span class="type">Val</span>&lt;<span class="type">Val_</span>&gt; = {#at : <a href="#type.Name"><span class="type">Name</span></a>; #array : <a href="#type.Array"><span class="type">Array</span></a>&lt;<span class="type">Val_</span>&gt;; #arrayStream : <a href="#type.ArrayStream"><span class="type">ArrayStream</span></a>&lt;<span class="type">Val_</span>&gt;; #nil; #cons : <a href="#type.Cons"><span class="type">Cons</span></a>&lt;<span class="type">Val_</span>&gt;; #bin : <a href="#type.Bin"><span class="type">Bin</span></a>&lt;<span class="type">Val_</span>&gt;; #leaf : <span class="type">Val_</span>; #pair : (<a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;, <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;)}</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Tree"><span class="keyword">type </span><span class="type">Tree</span>&lt;<span class="type">Val_</span>&gt; = {#nil; #bin : <a href="#type.Bin"><span class="type">Bin</span></a>&lt;<span class="type">Val_</span>&gt;; #leaf : <span class="type">Val_</span>; #at : <a href="#type.Name"><span class="type">Name</span></a>}</h4><p><p>Cartesian trees as balanced representations for sequences.</p>
</p></div><div class="declaration"><h4 class="type-declaration" id="type.Stream"><span class="keyword">type </span><span class="type">Stream</span>&lt;<span class="type">Val_</span>&gt; = {#nil; #cons : <a href="#type.Cons"><span class="type">Cons</span></a>&lt;<span class="type">Val_</span>&gt;; #arrayStream : <a href="#type.ArrayStream"><span class="type">ArrayStream</span></a>&lt;<span class="type">Val_</span>&gt;}</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.SeqType"><span class="keyword">type </span><span class="type">SeqType</span> = {#array; #stream; #tree; #pair}</h4><p><p>Each sequence representation has a different run-time type,
with associated checks for its operations.</p>
</p></div><div class="declaration"><h4 class="type-declaration" id="type.Result"><span class="keyword">type </span><span class="type">Result</span>&lt;<span class="type">X</span>, <span class="type">Val_</span>&gt; = <span class="type">R.Result</span>&lt;<span class="type">X</span>, <a href="#type.Error"><span class="type">Error</span></a>&lt;<span class="type">Val_</span>&gt;&gt;</h4><p><p>Result type for all &quot;meta level&quot; operations returning an <code>X</code>.</p>
</p></div><div class="declaration"><h4 class="type-declaration" id="type.EvalResult"><span class="keyword">type </span><span class="type">EvalResult</span>&lt;<span class="type">Val_</span>&gt; = <a href="#type.Result"><span class="type">Result</span></a>&lt;<a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;, <span class="type">Val_</span>&gt;</h4><p><p>Evaluation results in a <code>Val</code> on success.</p>
</p></div><div class="declaration"><h4 class="type-declaration" id="type.Error"><span class="keyword">type </span><span class="type">Error</span>&lt;<span class="type">Val_</span>&gt; = {#notOurVal : <span class="type">Val_</span>; #doNotHave : (<a href="#type.SeqType"><span class="type">SeqType</span></a>, <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;); #emptySequence; #engineError}</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Ops"><span class="keyword">type </span><span class="type">Ops</span>&lt;<span class="type">Exp_</span>, <span class="type">Val_</span>, <span class="type">Error_</span>&gt; = { valMax : (<span class="type">Val_</span>, <span class="type">Val_</span>) -&gt; <span class="type">R.Result</span>&lt;<span class="type">Val_</span>, <span class="type">Error_</span>&gt;; getVal : <span class="type">Val_</span> -&gt; ?<a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;; putExp : <a href="#type.Exp"><span class="type">Exp</span></a>&lt;<span class="type">Val_</span>&gt; -&gt; <span class="type">Exp_</span>; getExp : <span class="type">Exp_</span> -&gt; ?<a href="#type.Exp"><span class="type">Exp</span></a>&lt;<span class="type">Val_</span>&gt;; putVal : <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt; -&gt; <span class="type">Val_</span>; putError : <a href="#type.Error"><span class="type">Error</span></a>&lt;<span class="type">Val_</span>&gt; -&gt; <span class="type">Error_</span>; getError : <span class="type">Error_</span> -&gt; ?<a href="#type.Error"><span class="type">Error</span></a>&lt;<span class="type">Val_</span>&gt; }</h4><p></p></div><div class="declaration"><h4 class="class-declaration" id="type.Sequence"><span class="keyword">class </span><span class="classname">Sequence</span>&lt;<span class="type">Val_</span>, <span class="type">Error_</span>, <span class="type">Exp_</span>&gt;(<span class="parameter">engine</span> : <a href="../Engine.html#type.Engine"><span class="type">Engine.Engine</span></a>&lt;<a href="#type.Name"><span class="type">Name</span></a>, <span class="type">Val_</span>, <span class="type">Error_</span>, <span class="type">Exp_</span>&gt;, <span class="parameter">ops</span> : <a href="#type.Ops"><span class="type">Ops</span></a>&lt;<span class="type">Exp_</span>, <span class="type">Val_</span>, <span class="type">Error_</span>&gt;)</h4><div class="declaration"><h4 class="function" id="Sequence.eval"><code><span class="keyword">public func </span><span class="fnname">eval</span>(<span class="parameter">e</span> : <a href="#type.Exp"><span class="type">Exp</span></a>&lt;<span class="type">Val_</span>&gt;) : <span class="type">R.Result</span>&lt;<span class="type">Val_</span>, <span class="type">Error_</span>&gt;</code></h4><p><p>Evaluate expression into a result.</p>
</p></div><div class="declaration"><h4 class="function" id="Sequence.haveArray"><code><span class="keyword">public func </span><span class="fnname">haveArray</span>(<span class="parameter">v</span> : <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;) : <a href="#type.Result"><span class="type">Result</span></a>&lt;[(<a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;, <a href="#type.Meta"><span class="type">Meta</span></a>)], <span class="type">Val_</span>&gt;</code></h4><p><p>Check canonical array forms.</p>
</p></div><div class="declaration"><h4 class="function" id="Sequence.haveStream"><code><span class="keyword">public func </span><span class="fnname">haveStream</span>(<span class="parameter">v</span> : <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;) : <a href="#type.Result"><span class="type">Result</span></a>&lt;<a href="#type.Stream"><span class="type">Stream</span></a>&lt;<span class="type">Val_</span>&gt;, <span class="type">Val_</span>&gt;</code></h4><p><p>Check canonical stream head form.</p>
</p></div><div class="declaration"><h4 class="function" id="Sequence.haveTree"><code><span class="keyword">public func </span><span class="fnname">haveTree</span>(<span class="parameter">v</span> : <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;) : <a href="#type.Result"><span class="type">Result</span></a>&lt;<a href="#type.Tree"><span class="type">Tree</span></a>&lt;<span class="type">Val_</span>&gt;, <span class="type">Val_</span>&gt;</code></h4><p><p>Check canonical tree head form.</p>
</p></div><div class="declaration"><h4 class="function" id="Sequence.streamOfArray"><code><span class="keyword">public func </span><span class="fnname">streamOfArray</span>(<span class="parameter">v</span> : <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;) : <a href="#type.EvalResult"><span class="type">EvalResult</span></a>&lt;<span class="type">Val_</span>&gt;</code></h4><p><p>Transforms an array into a stream.</p>
</p></div><div class="declaration"><h4 class="function" id="Sequence.treeSize"><code><span class="keyword">public func </span><span class="fnname">treeSize</span>(<span class="parameter">t</span> : <a href="#type.Tree"><span class="type">Tree</span></a>&lt;<span class="type">Val_</span>&gt;) : <span class="type">Nat</span></code></h4><p><p>number of elms; ignore internal nodes</p>
</p></div><div class="declaration"><h4 class="function" id="Sequence.treeLevel"><code><span class="keyword">public func </span><span class="fnname">treeLevel</span>(<span class="parameter">t</span> : <a href="#type.Tree"><span class="type">Tree</span></a>&lt;<span class="type">Val_</span>&gt;) : <span class="type">Nat</span></code></h4><p></p></div><div class="declaration"><h4 class="function" id="Sequence.streamNext"><code><span class="keyword">public func </span><span class="fnname">streamNext</span>(<span class="parameter">s</span> : <a href="#type.Stream"><span class="type">Stream</span></a>&lt;<span class="type">Val_</span>&gt;) : ?<a href="#type.Cons"><span class="type">Cons</span></a>&lt;<span class="type">Val_</span>&gt;</code></h4><p></p></div><div class="declaration"><h4 class="function" id="Sequence.resultPairSplit"><code><span class="keyword">public func </span><span class="fnname">resultPairSplit</span>(<span class="parameter">r</span> : <a href="#type.EvalResult"><span class="type">EvalResult</span></a>&lt;<span class="type">Val_</span>&gt;) : <a href="#type.Result"><span class="type">Result</span></a>&lt;(<a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;, <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;), <span class="type">Val_</span>&gt;</code></h4><p></p></div><div class="declaration"><h4 class="function" id="Sequence.resultPair"><code><span class="keyword">public func </span><span class="fnname">resultPair</span>(<span class="parameter">v1</span> : <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;, <span class="parameter">v2</span> : <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;) : <a href="#type.EvalResult"><span class="type">EvalResult</span></a>&lt;<span class="type">Val_</span>&gt;</code></h4><p></p></div><div class="declaration"><h4 class="function" id="Sequence.treeOfStreamRec"><code><span class="keyword">public func </span><span class="fnname">treeOfStreamRec</span>(<br/>  <span class="parameter">parentLevel</span> : ?<span class="type">Nat</span>, <br/>  <span class="parameter">s</span> : <a href="#type.Stream"><span class="type">Stream</span></a>&lt;<span class="type">Val_</span>&gt;, <br/>  <span class="parameter">tree</span> : <a href="#type.Tree"><span class="type">Tree</span></a>&lt;<span class="type">Val_</span>&gt;<br/>) : <a href="#type.EvalResult"><span class="type">EvalResult</span></a>&lt;<span class="type">Val_</span>&gt;</code></h4><p><p>Transforms a stream into a tree.</p>
</p></div><div class="declaration"><h4 class="function" id="Sequence.treeOfStream"><code><span class="keyword">public func </span><span class="fnname">treeOfStream</span>(<span class="parameter">s</span> : <a href="#type.Val"><span class="type">Val</span></a>&lt;<span class="type">Val_</span>&gt;) : <a href="#type.EvalResult"><span class="type">EvalResult</span></a>&lt;<span class="type">Val_</span>&gt;</code></h4><p><p>Transforms a stream into a tree.</p>
</p></div><p></p></div></div></body></html>